---
title: "a4_task1_danielle_sclafani"
author: "Danielle Sclafani"
date: "11/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(here)
library(lubridate)
library(kableExtra)
library(dplyr)
library(ggplot2)
library(ggbeeswarm)
library(effsize)
```

### Bonanza Creek LTER
> This mini-report will explore counts and sizes of juvenile snowshow hares recorded in 1998-2012
> add introduction ( a and b- do these last)


```{r}
hare_data <- read_csv(here("bonanza_hares.csv")) #reading in csv, should not include this in final report

juv_data <- hare_data %>% 
  filter(age =="j") %>%
  mutate(year = mdy(date)) %>% 
  mutate(year_new = year(year)) %>% 
  group_by(year_new) %>%
  count(year_new) %>% 
  rename(Year = year_new) %>% 
  rename("Number of Hares" = n)

```


```{r, fig.cap= "Graph 1.0: Total Number of juvenile Hares caught across all testing sites in Bonanza from 1998-2012"}

juv_graph <- hare_data %>% 
  filter(age =="j") %>%
  mutate(year = mdy(date)) %>% 
  mutate(year_new = year(year)) %>% 
  group_by(year_new) %>%
  count(age)
  
ggplot(data = juv_graph, aes(x= year_new, y = n)) + geom_col(fill="cyan4") +
  labs(x = "Year", y = "Number of Juvenile Hares",
       title = "Number of Juvenile Hares recorded from 1998-2012")+
  scale_x_continuous(breaks = c(1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012))+
  theme(plot.title = element_text(hjust=0.5))
```


```{r}
sum_juv <- summary(juv_data)

sum_juv
```

> The number of juvenile Hares caught and recorded each year from 1998-2012 varies significantly. In 2008, no juvenile hares were caught and in 2010 only two were caught. While the maximum number of juvenile hares caught occurred in 1999, when 126 juvenile hares were caught. The mean number of juvenil hares captured is 31.5, however, due to this data's overskew the median is a more accurate central descriptive statsitic at 18.5 hares annually recorded. The overall trend of the number of hares recorded is a sharp decline over the years. It is unclear if the same amount of hours and number of traps were put into catching hares each year which would significantly influence the number of hares captured. In order to standardize the data it is important that the collection of data is standardized. The same number of traps should be used each year, in the same locations, and checked at the same frequencies. 

## Data Visualization of juvenile hares by sex and location

```{r}
juv_sex_loc <- hare_data %>%
  filter(age =="j") %>% 
  filter(!is.na(weight)) %>% 
  group_by(sex, grid) %>%
  count(weight) %>%
  mutate(gender = case_when(
    sex == "f"~ "Female",
    sex == "m" ~ "Male",
    sex == "NA" ~ "Undetermined"
  )) %>%
  mutate(site_name = case_when(
    grid == "bonbs" ~ "Mature Lowland",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonrip" ~ "Bonanza Riparian"))


```

```{r, fig.cap= "Graph 2.0: Number of male, female, and indeterminant sex of juvenile hares in grams, separated by trapping location."}
ggplot(data= juv_sex_loc, aes(x= gender)) + geom_bar(aes(fill=sex))+
  facet_wrap(~site_name) +
  labs(x = "Sex", y = "Number of Hares", 
       title = "Number of Juvenile Hares captured by Gender and Capture Site") +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")
```

```{r, fig.cap= "Graph 3.0: Weight in grams of juvenile hairs broke out by sex and trap site. Mean weight and one standard deviation above and below the mean are shown by the black data point and error bars on each plot."}
beaswarm_juv <- hare_data %>% 
filter(age =="j") %>% 
  filter(!is.na(weight)) %>%
  mutate(gender = case_when(sex == "f" ~ "Female",
    sex == "m"~ "Male")) %>% 
  mutate(site_name = case_when(
    grid == "bonbs" ~ "Mature Lowland",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonrip" ~ "Bonanza Riparian"
  ))

beaswarm_sum_juv <-beaswarm_juv %>% 
  group_by(sex, grid) %>% 
  summarize(mean_weight = mean(weight),
            sd_weight = sd(weight),
            sample = n()) %>% 
  mutate(gender = case_when(sex == "f" ~ "Female",
    sex == "m"~ "Male")) %>% 
  mutate(site_name = case_when(
    grid == "bonbs" ~ "Mature Lowland",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonrip" ~ "Bonanza Riparian"
  ))

ggplot() + geom_beeswarm(data = beaswarm_juv, aes(x= gender, y = weight, color = gender),
                         size = 2,
                         alpha = 0.6)+
  facet_wrap(~site_name)+
  geom_point(data = beaswarm_sum_juv, aes(x = gender, y = mean_weight),
             size = 3)+
  labs(x= "Sex", y ="Weight (g)",
       title = "Weight (g) of Juvenile Hairs by Sex and Trapping Site")+
  theme(plot.title = element_text(hjust=0.5),
        legend.position = "none")+
   geom_errorbar(data = beaswarm_sum_juv,
                aes(x=gender, 
                    ymax = mean_weight + sd_weight,
                    ymin = mean_weight - sd_weight),
                width=0.2,
                alpha=0.7)
```

> Graph 2.0 and Graph 3.0 show the distributions of male, female, and indeterminate hare weights across the three different testing sites. The general trend across the three testing sites shows that the mean weight of male juvenile hares is slightly larger than the mean weight of female juvenile hares. However, Graph 3.0 shows that maximum weight of a juvenile female hare in the Mature Lowland is heavier than the maximum weight of male juvenile hare, and the maximum weight of juvenile female hares at Bonanza Mature and Bonanza Riparian are almost equal to the maximum weight of juvenile male hares.At the Bonanza Mature and Bonanza Riparian testing sites, there were several observations resulting in an indeterimant sex, while all hares captured at Mature Lowland had clear sexual classifications. According to Graph 2.0, there are significantly more female hares than male hares in the Mature Lowlands. The other two testing sites have a slightly higher amount of male juvenile hares. Over the course of the study, Bonanza Riparian caught more total juvenile hares than the other two testing sites.

### iii. Juvenile weight comparison (male and female snowshoe hares)

```{r, fig.cap= "Table 1.0: Summary Statistics of male and female juvenile hares caught across all testing sites from 1998-2012. Testing sites include Bonanza Mature, Bonanza Riparian, and Mature Lowland trapping sites. Indeterminant sex hares are excluded from these summary statistics"}

## getting descriptive statistics 

hare_table <- hare_data %>% 
  filter(age == "j") %>%
  filter(!is.na(weight)) %>%
  filter(sex %in% c("f", "m")) %>% 
  mutate(gender = case_when(sex == "f" ~ "Female",
    sex == "m"~ "Male")) %>% 
  mutate(site_name = case_when(grid == "bonbs" ~ "Mature Lowland",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonrip" ~ "Bonanza Riparian")) %>% 
  group_by(gender) %>% 
  summarize(mean_weight = mean(weight),
            sd_weight = sd(weight),
            sample = n()) %>% 
  rename(Sex = gender,
         "Mean Weight (g)" = mean_weight,
         "Standard Deviation (g)" = sd_weight,
         "Sample Size" = sample)

kable(hare_table) %>% 
  kable_classic(full_width = F) %>% 
  add_header_above(c("Summary Statistics of Juvenile Female and Male Hares captured" = 4))
```

### iv. exploratory graphs of male vs female hares

```{r}
juv_explor_data <- hare_data %>% 
  filter(age == "j") %>% 
  filter(sex %in% c("f", "m")) %>% 
  filter(!is.na(weight))

ggplot(data = juv_explor_data, aes(x= weight)) + geom_histogram() + facet_wrap(~sex)
```


```{r}
ggplot(data=juv_explor_data, aes(sample=weight)) + geom_qq() + facet_wrap(~sex)
```

### v. creating the vectors for the two sample t-test

```{r}
#creates vectors of male and female juvenile weight

fem_juv_hare <- juv_explor_data %>% 
  filter(sex == "f") %>% 
  pull(weight)

male_juv_hare <-juv_explor_data %>% 
  filter(sex == "m") %>% 
  pull(weight)

```

### t-test

```{r}
hare_ttest <- t.test(male_juv_hare, fem_juv_hare, alternative = "greater") # by putting it in this order, we are able to test if males are larger than females- should rewatch this part of week 5 code along, need to understand this better as well as cohen.ds
hare_ttest
```

## What does cohen's mean?
```{r}
cohen.d(fem_juv_hare, male_juv_hare)
```

